---
layout: default
title: Home
---
<style>
    .jumbotron {
    background-color:transparent !important;
    }
    .chart {
        height: 400px;
    }
    /*div {*/
    /*    border: 1px solid black;*/
    /*}*/
    /*.selectNumber {*/
    /*    padding-top: 50px;*/
    /*}*/
    body {
        padding-top: 70px;
    }
    
	.rickshaw_graph .detail {
		background: none;
	}
	
	/*.drop {*/
	/*    height: 50px;*/
	/*}*/

</style>

<!--<div id = "region" class = "container d-flex justify-content-end position-fixed ">-->
<!--<select id = "region_selector" name="regionselect" class="selectpicker ">-->
<!--  <option value='1' >Illinois</option>-->
<!--  <option value = "covid">Region 1</option>-->
<!--  <option>Region 2</option>-->
<!--  <option>Region 3</option>-->
<!--  <option>Region 4</option>-->
<!--  <option>Region 5</option>-->
<!--  <option>Region 6</option>-->
<!--  <option>Region 7</option>-->
<!--  <option>Region 8</option>-->
<!--  <option>Region 9</option>-->
<!--  <option>Region 10</option>-->
<!--  <option>Region 11</option>-->
<!--</select>-->

<!--</div>-->

<!--<div class="ui dropdown">-->
<!--  <div class="text"></div>-->
<!--  <i class="dropdown icon"></i>-->
<!--</div>-->

<!--<div id = "region" class = "container justify-content-end position-fixed ">-->
<!--<select id = "region_selector" name="regionselect" class="selectpicker ">-->
<!--</select>-->

<!--</div>-->
<!--<div class = "container position-fixed">-->
<!--    <div class = "row">-->
<!--        <div class = "col drop">-->
<!--            <select id="selectButton" class = "dropdown float-right"  ></select>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<div class = "container position-relative ">-->
<!--    <div class="dropdown position-fixed ">-->
<!--        <select id="selectButton" class = "dropdown-item"  ></select>-->
<!--    </div>-->
<!--</div>-->


<div class="container jumbotron">
    <div class="row">
        <div class="col">
            <h2>Transmission Status</h2>
            <p>Example subheading</p>
            <div class="chart" id = "rt_chart"></div>
            <!--<br></br>-->
            <text>Example text to decribe chart</text>
        </div>
    </div>
</div>

<!--<div class="dropdown ">-->
<!--<select id="selectButton" class = "dropdown-item"></select>-->

<!--</div>-->

<!--<div class="dropdown">-->
<!--  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
<!--    Dropdown button-->
<!--  </button>-->
<!--  <select id="selectButton" class = "dropdown-menu"></select>-->
  <!--<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">-->
  <!--  <a class="dropdown-item" href="#">Action</a>-->
  <!--  <a class="dropdown-item" href="#">Another action</a>-->
  <!--  <a class="dropdown-item" href="#">Something else here</a>-->
  <!--</div>-->
<!--</div>-->

<!--<div class="dropdown">-->
<!--  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
<!--    Dropdown button-->
<!--  </button>-->
<!--  <div id = "drop" class="dropdown-menu" aria-labelledby="dropdownMenuButton">-->
<!--    <a class="dropdown-item" href="#">Action</a>-->
<!--    <a class="dropdown-item" href="#">Another action</a>-->
<!--    <a class="dropdown-item" href="#">Something else here</a>-->
<!--  </div>-->
<!--</div>-->



<div class="container jumbotron">
    <div class="row">
        <div class="col">
            <h2>Cases Map and Chart</h2>
            <div class = "row"> 
                <div class="col-sm-12 col-md-4 col-lg-3 chart"> 
                    <div class="chart" id = "cases_map"></div>
                </div>
                <div class="col-sm-12 col-md-8 col-lg-9 chart">
                    <div class="chart" id = "cases_chart"></div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container jumbotron">
    <div class="row">
        <div class="col">
            <h2>Deaths Map and Chart</h2>
            <div class = "row"> 
                <div class="col-sm-12 col-md-4 col-lg-3 chart"> 
                    <div class="chart" id = "deaths_map"></div>
                </div>
                <div class="col-sm-12 col-md-8 col-lg-9 chart">
                    <div class="chart" id = "deaths_chart"></div>
                </div>
            </div>
        </div>
    </div>
</div>


<script>


/* 
TODO:
-Dropdown Menu
  - alignment - put inside nav bar? / combine
  - sort regions, illinois to top
  - style 
    - collapsed button (that works)
    - uncollapsed list 


-adjust y-axis scale with dropdown change
*/



  /* global d3 */
  
  var margin = {top: 10, right: 20, bottom: 20, left: 20}, height = 300;
  // append the svg object to the body of the page
  var svg = d3.select("#rt_chart")
              .append("svg")
              .attr("height", height + margin.top + margin.bottom);
  
  d3.json("/data/rt.json").then(function(data) {
    // filers NaN and converts strings
    let parseDate = d3.timeParse("%m/%d/%Y");
    data = data.filter(function(d){
      if(isNaN(d.rt_median)){
        return false;
      }
      d.rt_lower = +d.rt_lower;
      d.rt_median = +d.rt_median;
      d.rt_upper = +d.rt_upper;
      d.date = parseDate(d.date);
      return true;
    });
    
    // array of regions - TODO: need to sort, move Illinois to front
    var allGroup = d3.map(data, function(d){return(d.geography_modeled)}).keys();
    
    // add the options to the button
    d3.select("#selectButton")
      .selectAll('myOptions')
     	.data(allGroup)
      .enter()
    	.append('option')
      .text(function (d) { 
          if(d == "illinois" ||d == "Illinois" ) {
              return "Illinois";
          }
          d = "Region " + d.substring( d.indexOf('_')+1);
          return d; 
      })
      .attr("value", function (d) { return d; })
      .attr("class", "dropdown-item")

    var myColor = d3.scaleOrdinal()
                    .domain(allGroup)
                    .range(d3.schemeSet2);
      
    var lightColors = d3.scaleOrdinal()
                        .domain(allGroup)
                        .range(d3.schemePastel2);
      
    var x = d3.scaleTime()
              .domain(d3.extent(data, function(d) { return d.date}))
    var xAxis = svg.append("g")
                  .attr("transform", "translate( 0," + height + ")");
      
    var y = d3.scaleLinear()
              // .domain([0, 7]) 
              .domain([0, d3.max(data, function(d) { return d.rt_upper })])
              .range([ height, 5 ]);
    var yAxis = svg.append("g")
                   .attr("class", "y axis")
                  // .attr("transform", "translate("+ 30 +",0)")
                  .attr("transform", "translate("+ margin.left +",0)")
                   
                   .call(d3.axisLeft(y).ticks(6));
    
    var interval = svg.append("path")
                      .datum(data.filter(function(d){return d.geography_modeled==allGroup[0]}))
                      .attr("fill", function(d){ return lightColors(allGroup[0]) })
                      .attr("stroke", "none")
                      .attr("transform", "translate(1,0)")
        
  // Initialize line with first group of the list
    var line = svg.append('g')
                  .append("path")
                  .datum(data.filter(function(d){return d.geography_modeled==allGroup[0]}))
                  .attr("stroke", function(d){ return myColor(allGroup[0]) })
                  .attr("transform", "translate(1,0)")
                  .style("stroke-width", 4)
                  .style("fill", "none")
                  
                  
    // A function that finishes to draw the chart for a specific device size.
    function drawChart() {
      
      // get the current width of the div where the chart appear, and attribute it to Svg
      // currentWidth = parseInt(d3.select('#rt_chart').style('width'), 10) + margin.left + margin.right
      var currentWidth = document.getElementById("rt_chart").offsetWidth
      
      svg
      .attr("width", currentWidth)
      .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
         
      // Update the X scale and Axis (here the 20 is just to have a bit of margin)
      x.range([ 20, currentWidth-20 ]);
      
      xAxis.call(d3.axisBottom(x).ticks(5));
      
      interval
      .attr("d", d3.area()
      .x(function(d) { return x(d.date) })
      .y0(function(d) { return y(d.rt_lower) })
      .y1(function(d) { return y(d.rt_upper) }))
      
      line
      .attr("d", d3.line()
      .x(function(d) { return x(d.date) })
      .y(function(d) { return y(d.rt_median) })
      )
    }
    // Initialize the chart
    drawChart();
    // Add an event listener that run the function when dimension change
    window.addEventListener('resize', drawChart ); 
    
    
    // A function that updates the chart
    function update(selectedGroup) {
      // Create new data with the selection?
      var dataFilter = data.filter(function(d){return d.geography_modeled==selectedGroup})
      
      interval
      .datum(dataFilter)
      .transition()
      .duration(1000)
      .attr("fill", function(d){ return lightColors(selectedGroup) })
      .attr("stroke", "none")
      .attr("d", d3.area()
            .x(function(d) { return x(d.date) })
            .y0(function(d) { return y(d.rt_lower) })
            .y1(function(d) { return y(d.rt_upper) })
            )
      
      // Give these new data to update line
      line
      .datum(dataFilter)
      .transition()
      .duration(1000)
      .attr("d", d3.line()
            .x(function(d) { return x(d.date) })
            .y(function(d) { return y(d.rt_median) })
            )
            .attr("stroke", function(d){ return myColor(selectedGroup) })
    }
    
    // When the button is changed, run the updateChart function
    d3.select("#selectButton").on("change", function(d) {
      // recover the option that has been chosen
      var selectedOption = d3.select(this).property("value")
      // run the updateChart function with this selected option
      console.log(selectedOption)
      update(selectedOption)
    })
});

// var margin_cases = {top: 10, right: 30, bottom: 30, left: 50},
//     width_cases = document.getElementById("cases_chart").offsetWidth,
//     height_cases = document.getElementById("cases_chart").offsetHeight;
  var svg_cases = d3.select("#cases_chart")
              .append("svg")
              .attr("height", height + margin.top + margin.bottom);

d3.json("/data/cases_deaths.json").then(function(data) {
    let parseDate = d3.timeParse("%Y-%m-%d");
    data = data.filter(function(d){
        if(isNaN(d.cases_median) || isNaN(d.deaths_median) ){
            return false;
        }
        d.cases_median = +d.cases_median;
        d.deaths_median = +d.deaths_median;
        d.date = parseDate(d.date);
        return true;
    });
    
    var allGroup = d3.map(data, function(d){return(d.geography_modeled)}).keys();
    
    console.log(allGroup);
    var myColor = d3.scaleOrdinal()
                    .domain(allGroup)
                    .range(d3.schemeSet2);
      
    var lightColors = d3.scaleOrdinal()
                        .domain(allGroup)
                        .range(d3.schemePastel2);

    // Add X axis --> it is a date format
    var x = d3.scaleTime()
      .domain(d3.extent(data, function(d) { return d.date; }))
      // .range([ 0, width_cases ]);
    var xAxis = svg_cases.append("g")
      .attr("transform", "translate(0," + height + ")")
      // .call(d3.axisBottom(x));

    // Add Y axis
    var y = d3.scaleLinear()
      .domain([0, d3.max(data, function(d) { return d.cases_median; })])
      .range([ height, 0 ]);
    var yAxis = svg_cases.append("g")
    .attr("class", "y axis")
    .attr("transform", "translate("+ (margin.left+50) +",0)")
      .call(d3.axisLeft(y));

    // Add the area
    var area = svg_cases.append("path")
      .datum(data.filter(function(d){return d.geography_modeled==allGroup[0]}))
      .attr("fill", "#cce5df")
      .attr("stroke", "#69b3a2")
      .attr("stroke-width", 1.5)
      .attr("transform", "translate(2,-1)");
      // .attr("transform", "translate(10," + 0 + ")")
      // .attr("d", d3.area()
      //   .x(function(d) { return x(d.date) })
      //   .y0(y(0))
      //   .y1(function(d) { return y(d.cases_median) })
      //   )
        
            // A function that finishes to draw the chart for a specific device size.
    function drawChart() {
      
      // get the current width of the div where the chart appear, and attribute it to Svg
      // currentWidth = parseInt(d3.select('#rt_chart').style('width'), 10) + margin.left + margin.right
      var currentWidth = document.getElementById("cases_chart").offsetWidth;
      
      svg_cases
      .attr("width", currentWidth)
      .append("g")
      // .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
         
      // Update the X scale and Axis (here the 20 is just to have a bit of margin)
      x.range([ 70, currentWidth-70 ]);
      
      xAxis.call(d3.axisBottom(x).ticks(5));
      
      area
      .attr("d", d3.area()
      .x(function(d) { return x(d.date) })
      .y0(y(0))
      .y1(function(d) { return y(d.cases_median) })
      )
    }
    // Initialize the chart
    drawChart();
    window.addEventListener('resize', drawChart ); 
});

console.log("hi")





</script>